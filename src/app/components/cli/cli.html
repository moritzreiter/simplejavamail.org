<div class="content">

  <h1>Simple Java Mail Command Line Interface</h1>

  <section class="introduction">
    <p class="wide">
      Simple Java Mail exposes the complete builder API as CLI commands, which is to say everything you can do with
      Simple Java Mail in Java, you can also do that in a terminal.
    </p>

    <h2>From builder API to CLI commands</h2>

    <p class="wide">
      To support CLI, the commands and options are generated using <a href="https://picocli.info/">Picocli's Java API</a>
      and <a href="https://github.com/dnault/therapi-runtime-javadoc">Therapi's Javadoc bundler</a>. Together and with a
      lot of custom glue Simple Java Mail's builder API is traversed and converted into CLI commands.
    </p>
    <p class="wide">
      The great benefit from this is that new builder API is supported by CLI automagically and the documentation is
      still centralized in the builder API, providing a consistent experience.
    </p>
  </section>

  <section class="toc">
    <ul>
      <li><a simplePageScroll href="#section-how-to-use">How to use</a></li>
      <li><a simplePageScroll href="#section-usage-help" class="indent">Usage help</a></li>
      <li><a simplePageScroll href="#section-at-files" class="indent">@-files</a></li>
      <li><a simplePageScroll href="#section-config-properties" class="indent">Configuring properties</a></li>
      <li><a simplePageScroll href="#section-config-logging" class="indent">Configuring logging</a></li>
      <li><a simplePageScroll href="#section-invoking-cli-manually">Invoking CLI manually</a></li>
      <li><a simplePageScroll href="#section-or-by-maven" class="indent">Or by Maven</a></li>
    </ul>
  </section>


  <a href="#section-how-to-use" id="section-how-to-use" class="section-link h2">&sect;</a>
  <h2>How to use</h2>

  <section>
    <p class="wide">
      To use Simple Java Mail CLI,
      <a [routerLink]="['/download']" simplePageScroll href="#navigation">Download</a>
      and expand the standalone-cli package and execute the <em>sjm</em> script.
      Included in the package are all dependencies and two helper scripts for Windows and Unix (generated by standard
      Maven plugins).
    </p>
    <p class="wide">
      The flags are a bit verbose, but then it supports the complete builder API!
    </p>
    <pre><code class="language-text small">
      sjm
      sjm --help
      sjm send
          --email:startingBlank
          --email:from "Mr. Candy" mrcandy@candystore.com
          --email:withSubject "About those tongue twisters"
          --email:to "Sweet Cheeks" "sweet.cheeks@candystore.com"
          --email:cc "Candy Research Group" "&lt;james@candy-insights.com&gt;;&lt;jean@candy-insights.com&gt;"
          --email:bcc "box1 &lt;info-box@candystore.com&gt;,box2 &lt;reminders@candystore.com&gt;"
          --email:withPlainText "I discovered a new flavor! (..)"
          --mailer:withSMTPServer "my-smtp-server.com" 1234 "myuser" "mypass"
          --mailer:withTransportStrategy "SMTP_TLS"
    </code></pre>
    <p>
      You can also check the <a href="https://github.com/bbottema/simple-java-mail/tree/develop/src/test/java/demo">demo code</a>
      included in the sources.
    </p>
  </section>


  <a href="#section-usage-help" id="section-usage-help" class="section-link h3">&sect;</a>
  <h3>Usage Help</h3>

  <section>
    <p>You can get usage information displayed on any level:</p>
    <table>
      <colgroup>
        <col span="1" style="width: 15%;">
        <col span="1" style="width: 40%;">
        <col span="1">
      </colgroup>

      <!-- Put <thead>, <tbody>, and <tr>'s here! -->
      <tbody>
      <tr>
        <td>Global level</td>
        <td><code class="language-text inline">--help</code></td>
        <td>informs about available commands</td>
      </tr>
      <tr>
        <td>Command level</td>
        <td><code class="language-text inline">send --help</code></td>
        <td>informs about options available for the "send" command</td>
      </tr>
      <tr>
        <td>Option level</td>
        <td><code class="language-text inline">send --email:withSubject--help</code></td>
        <td>displays usage help for the "withSubject" option</td>
      </tr>
      </tbody>
    </table>
  </section>


  <a href="#section-at-files" id="section-at-files" class="section-link h3">&sect;</a>
  <h3>@-files</h3>

  <section>
    <p class="wide">
      If you run into a character limit in your console, you can also use "argument files" or "@-files", which is
      supported in <a href="https://picocli.info/#AtFiles">Picocli</a>, the library used under the hood:
    </p>
    <pre><code class="language-text">
      # /home/foo/args
      --email:withSubject "My Subject"
      --mailer:withSMTPServer host=...
      # ...other arguments
    </code></pre>
    <p class="wide">The command <code class="language-text inline">sjm @/home/foo/args</code> then is expanded to:</p>
    <pre><code class="language-text">
      sjm --email:withSubject "My Subject" --mailer:withSMTPServer host=...
    </code></pre>
    <p class="wide">
      Quoting the Picocli documentation:
    </p>
    <blockquote>
      <p class="wide">
        This feature is similar to the 'Command Line Argument File' processing supported by gcc, javadoc and javac.
        The documentation for these tools shows further examples.
      </p>
      <p class="wide">
        From picocli 3.8.1, a simpler argument file format is also supported where every line (except comment lines)
        is interpreted as a single argument. Arguments containing whitespace do not need to be quoted, but it is not
        possible to have arguments with embedded newlines.
      </p>
      <p class="wide">
        Set system property <code class="inline">picocli.useSimplifiedAtFiles</code> without a value or with value
        <code class="inline">"true"</code> (case-insensitive) to enable this simpler argument file format. This simplified
        format is similar to the argument file format supported by <a href="http://jcommander.org/#__syntax">JCommander</a>.
      </p>
    </blockquote>
  </section>


  <a href="#section-config-properties" id="section-config-properties" class="section-link h3">&sect;</a>
  <h3>Configuring properties</h3>

  <section>
    <p class="wide">
      With the provided scripts, anything added to the \etc folder is visible on the classpath. In the current release,
      you can add your simplejavamail.properties there and it will be picked up.
    </p>
    <img src="../../assets/sjm etc.png">
  </section>


  <a href="#section-config-logging" id="section-config-logging" class="section-link h3">&sect;</a>
  <h3>Configuring logging</h3>

  <section>
    <p class="wide">
      In the current release, log4j2 properties as supported and you can simply edit the provided log4j2.xml in the
      /etc folder (see above).
    </p>
  </section>


  <a href="#section-invoking-cli-manually" id="section-invoking-cli-manually" class="section-link h2">&sect;</a>
  <h2>Invoking CLI manually</h2>

  <section>
    <p class="wide">
      If you wish to directly invoke the CLI from the jar or class files, CLI support for Java libraries works
      just like any other Java static void main invocation:
    </p>
    <pre><code class="language-text">java -cp all;the;jars.jar org.simplejavamail.cli.SimpleJavaMail --help</code></pre>
    <p class="wide">
      Simple Java Mail's own main jar should be on the classpath of course, as well as all non-optional dependencies,
      the optional cli-module dependency and <em>its</em> dependencies.
    </p>
    You can add a simplejavamail.properties file to the classpath this way which will automatically be picked for
    defaults and configuration.
  </section>


  <a href="#section-or-by-maven" id="section-or-by-maven" class="section-link h3">&sect;</a>
  <h3>Or by Maven</h3>

  <section>
    <p class="wide">
      Alternatively, you can also let Maven deal with the dependencies, by invoking the maven-exec plugin.
    </p>
    <pre><code class="language-text">mvn exec:java -Dexec.mainClass="org.simplejavamail.cli.SimpleJavaMail" -Dexec.args="--help"</code></pre>
    Or by configuring it in your POM:
    <pre><code class="small language-xml">
&lt;build&gt;
  &lt;plugins&gt;
    &lt;plugin&gt;
      &lt;groupId&gt;org.codehaus.mojo&lt;/groupId&gt;
      &lt;artifactId&gt;exec-maven-plugin&lt;/artifactId&gt;
      &lt;version&gt;1.6.0&lt;/version&gt;
      &lt;executions&gt;
        &lt;execution&gt;
          &lt;goals&gt;&lt;goal&gt;java&lt;/goal&gt;&lt;/goals&gt;
        &lt;/execution&gt;
      &lt;/executions&gt;
      &lt;configuration&gt;
        &lt;mainClass&gt;org.simplejavamail.cli.SimpleJavaMail&lt;/mainClass&gt;
        &lt;arguments&gt;
          &lt;argument&gt;--help&lt;/argument&gt;
        &lt;/arguments&gt;
      &lt;/configuration&gt;
    &lt;/plugin&gt;
  &lt;/plugins&gt;
&lt;/build&gt;
    </code></pre>
    <pre><code class="language-text">mvn exec:java</code></pre>
  </section>
</div>
